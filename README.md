# Online Chat Messenger Stage1

以下に、提供された機能要件・非機能要件をクライアントとサーバーに分類してまとめる。

## クライアント

### 機能要件
<!-- - CLI（コマンドラインインターフェース）を通じサーバーへ接続する。 -->
<!-- - サーバーとのメッセージのやり取りにUDPネットワークソケットを使用する。 -->
<!-- - 一度に最大4096バイトのメッセージをサーバーへ送信可能。 -->
<!-- - セッション開始時、ユーザーにユーザー名の入力を促す。 -->
- メッセージ送信時、以下のプロトコルに従いデータを構成する。
    - 最初の1バイト（`usernamelen`）：ユーザー名のバイトサイズ（最大255バイト）。
    - 続く`usernamelen`バイト：ユーザー名。
    - それ以降のバイト：実際のメッセージ。
    <!-- - 送受信するバイトデータはUTF-8でエンコード・デコードする。 -->
- サーバーから受信したメッセージを表示する（ユーザー名を含む）。

## サーバー

### 機能要件
<!-- - CLIで起動し、バックグラウンドでクライアントからの着信接続を待ち受ける。 -->
- サーバーがオフラインの場合、チャットサービス全体は停止する。
<!-- - クライアントとのメッセージのやり取りにUDPネットワークソケットを使用する。 -->
<!-- - クライアントから一度に最大4096バイトのメッセージを受信処理する。 -->
- 受信したメッセージを、接続中の他の全てのクライアントへ最大4096バイトで転送する。
- メッセージ受信時、以下のプロトコルに従いデータを解析する。
    - 最初の1バイト（`usernamelen`）を読み取り、ユーザー名の長さを特定する。
    - 続く`usernamelen`バイトを読み取り、送信者のユーザー名を特定する。
    - それ以降のバイトを実際のメッセージとして処理する。
<!-- - 送受信するバイトデータはUTF-8でエンコード・デコードする。 -->
- リレーシステムを実装し、現在接続中の全てのクライアント情報を一時的にメモリ上へ保存する。
- 新しいメッセージ受信時、そのメッセージを現在接続中の全てのクライアントへリレー（転送）する。
- 各クライアントの最後のメッセージ送信時刻を追跡する。
- クライアントが何回か連続で通信に失敗、または一定期間メッセージを送信していない場合、そのクライアントをリレーシステムから自動的に削除する。

## 非機能要件（主にサーバー、一部クライアントにも関連）

### **システム全体（特にサーバーの設計思想）**
- リアルタイムのデータ伝送を、信頼性よりも優先（UDPの選択理由）。

### **サーバー**
- 毎秒最低で10,000パケットの送信をサポートする必要がある。
    - 例：1000人のユーザーがいる場合、毎秒最低10メッセージを処理できる能力が求められる。